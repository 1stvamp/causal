<script type="text/javascript">
    //<![CDATA[
    function add_marker(map, lat, longg, contentString){
        var myLatlng = new google.maps.LatLng(lat, longg);
        var marker = new google.maps.Marker({
            position: myLatlng,
            map: map
        });

        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        google.maps.event.addListener(marker, 'click', function() {
            infowindow.open(map,marker);
        });
    }

    $(function() {
        var latlng = new google.maps.LatLng(53.853418499999997, -0.44196809999999997);
        var myOptions = {
            zoom: 10,
            center: latlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        {% for tweet in tweets %}
            {% if tweet.location %}
            var content = '{{ tweet.body|safe|escapejs }}';
                add_marker(map, {{ tweet.location.lat }}, {{ tweet.location.long }}, content);
            {% endif %}
        {% endfor %}
    });
    //]]>
</script>

<div id="map_canvas" style="width:600px; height:600px"></div>
<img src="http://chart.apis.google.com/chart?chs=300x225&cht=p3&chd=t:{{non_retweets}},{{retweets}}&chdl=tweets|retweets" width="300" height="225" alt="" />
<ul>
    People you @'ed
    {% for a, t in atters.iteritems %}
        <li>{{ a }} : {{ t }} times</li>
    {% endfor %}
</ul>
